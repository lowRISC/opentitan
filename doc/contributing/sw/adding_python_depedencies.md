# Python Dependency Management

To comply with software supply chain security requirements of various project partner organizations, we pin our Python packages to specific versions, and provide hashes for each dependency (including transitive dependencies).
We accomplish this with the help of the `uv pip compile` command, which is part of the `uv` package.

Additionally, to make it easier for downstream Bazel projects to dependend on this Bazel project (`@lowrisc_opentitan`), we vendor in the autogenerated `requirements.bzl` file produced by `rules_python`, see the `rules_python` [documentation](https://rules-python.readthedocs.io/en/0.39.0/pypi-dependencies.html#vendoring-the-requirements-bzl-file) for more details.

# Adding Python Dependencies to the Project
If you need to add another Python package to the project, do so by:
1. adding the package and version number to the `pyproject.toml` file, in the form of `<package>~=<version>`  (or `<package> == <version>` in case a specific version is needed),
1. running the script `util/sh/scripts/gen-python-requirements.sh`, which will auto-generate the updated `python-requirements.txt` file as shown below, and
1. running the `//third_party/python:vendor_requirements` Bazel target which will update the vendored in `requirements.bzl` file as shown below.

```sh
# Update autogenerated python package management files.
./util/sh/scripts/gen-python-requirements.sh
bazel run //third_party/python:vendor_requirements

# Check that the package management files are up to date.
bazel test //third_party/python/...
```
