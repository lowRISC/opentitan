# Copyright lowRISC contributors (OpenTitan project).
# Licensed under the Apache License, Version 2.0, see LICENSE for details.
# SPDX-License-Identifier: Apache-2.0

- name: mod
  address: 0
  doc: |
    The modulus used by the {{#otbn-insn-ref BN.ADDM}} and {{#otbn-insn-ref BN.SUBM}} instructions.
    This WSR is also visible as CSRs `MOD0` through to `MOD7`.

- name: rnd
  address: 1
  read-only: true
  doc: |
    An AIS31-compliant class PTG.3 random number with guaranteed entropy and forward and backward secrecy.
    Primarily intended to be used for key generation.

    The number is sourced from the EDN via a single-entry cache.
    Reads when the cache is empty will cause OTBN to be stalled until a new random number is fetched from the EDN.

- name: urnd
  address: 2
  read-only: true
  doc: |
    A random number without guaranteed secrecy properties or specific statistical properties.
    Intended for use in masking and blinding schemes.
    Use RND for high-quality randomness.

    The number is sourced from an local PRNG.
    Reads never stall.

- name: acc
  address: 3
  doc: |
    The accumulator register used by the {{#otbn-insn-ref BN.MULQACC}} instruction.

- name: key_s0_l
  address: 4
  read-only: true
  doc: |
    Bits [255:0] of share 0 of the 384b OTBN sideload key provided by the [Key Manager](../keymgr/README.md).

    A `KEY_INVALID` software error is raised on read if the Key Manager has not provided a valid key.

- name: key_s0_h
  address: 5
  read-only: true
  doc: |
    Bits [255:128] of this register are always zero.
    Bits [127:0] contain bits [383:256] of share 0 of the 384b OTBN sideload key provided by the [Key Manager](../keymgr/README.md).

    A `KEY_INVALID` software error is raised on read if the Key Manager has not provided a valid key.

- name: key_s1_l
  address: 6
  read-only: true
  doc: |
    Bits [255:0] of share 1 of the 384b OTBN sideload key provided by the [Key Manager](../keymgr/README.md).

    A `KEY_INVALID` software error is raised on read if the Key Manager has not provided a valid key.

- name: key_s1_h
  address: 7
  read-only: true
  doc: |
    Bits [255:128] of this register are always zero.
    Bits [127:0] contain bits [383:256] of share 1 of the 384b OTBN sideload key provided by the [Key Manager](../keymgr/README.md).

    A `KEY_INVALID` software error is raised on read if the Key Manager has not provided a valid key.

- name: kmac_data_s0
  address: 8
  doc: |
    KMAC_DATA_S0 is the first 256-bit share of the masked message or digest interface.

    For masked operations, provide the first share here and the second share in KMAC_DATA_S1.

    If masking is not required:
    - Set this share to the plaintext data.
    - Set the other share to all-zeros.

    The digest data is provided in chunks of 64 bits at a time.
    For plaintext retrieval of the digest, software must XOR the values from KMAC_DATA_S0 and KMAC_DATA_S1.
  bits:
    63-0: |
      Write: Least significant word of the message share.
      Read: Current 64-bit word of the digest share.
    255-64: |
      Write: Words 1-3 of the message share.
      Read: Returns `0`. Digest shares are read out via the least significant word only.

- name: kmac_data_s1
  address: 9
  doc: |
    KMAC_DATA_S1 is the second 256-bit share of the masked message or digest interface.

    For masked operations, provide the second share here and the second share in KMAC_DATA_S0.

    If masking is not required:
    - Set this share to the plaintext data.
    - Set the other share to all-zeros.

    The digest data is provided in chunks of 64 bits at a time.
    For plaintext retrieval of the digest, software must XOR the values from KMAC_DATA_S0 and KMAC_DATA_S1.
  bits:
    63-0: |
      Write: Least significant word of the message share.
      Read: Current 64-bit word of the digest share.
    255-64: |
      Write: Words 1-3 of the message share.
      Read: Returns `0`. Digest shares are read out via the least significant word only.

- name: mai_res_s0
  address: 10
  read-only: true
  doc: |
    This WSR holds share 0 of the masked results produced by the MAI.
    The results are organized as eight 32-bit values.
    Results are valid when MAI is not busy anymore.
    These values are overwritten when the first results of the next execution are available (this depends on the selected accelerator's latency).

- name: mai_res_s1
  address: 11
  read-only: true
  doc: |
    This WSR holds share 1 of the masked results produced by the MAI.
    The results are organized as eight 32-bit values.
    Results are valid when MAI is not busy anymore.
    These values are overwritten when the first results of the next execution are available (this depends on the selected accelerator's latency).

- name: mai_in0_s0
  address: 12
  doc: |
    This WSR transfers share 0 of the first input secrets towards the MAI.
    The inputs are considered as eight 32-bit values.
    Writing to this WSR while MAI is not ready will cause a MAI_ERROR software error.

- name: mai_in0_s1
  address: 13
  doc: |
    This WSR transfers share 1 of the first input secrets towards the MAI.
    The inputs are considered as eight 32-bit values.
    Writing to this WSR while MAI is not ready will cause a MAI_ERROR software error.

- name: mai_in1_s0
  address: 14
  doc: |
    This WSR transfers share 0 of the second input secrets towards the MAI.
    The inputs are considered as eight 32-bit values.
    Writing to this WSR while MAI is not ready will cause a MAI_ERROR software error.

- name: mai_in1_s1
  address: 15
  doc: |
    This WSR transfers share 1 of the second input secrets towards the MAI.
    The inputs are considered as eight 32-bit values.
    Writing to this WSR while MAI is not ready will cause a MAI_ERROR software error.
