# Copyright lowRISC contributors.
# Licensed under the Apache License, Version 2.0, see LICENSE for details.
# SPDX-License-Identifier: Apache-2.0

LICENSE_BANNER = [
    "Copyright lowRISC contributors.",
    "Licensed under the Apache License, Version 2.0, see LICENSE for details.",
    "SPDX-License-Identifier: Apache-2.0",
]

AUTOGEN_BANNER = [
    "-------------------------------------------------------------------",
    "----- W A R N I N G: A U T O - G E N E R A T E D   C O D E !! -----",
    "DO NOT EDIT THIS FILE DIRECTLY. IT HAS BEEN AUTO-GENERATED WITH THE",
    "FOLLOWING COMMAND:",
    "{command}",
    "-------------------------------------------------------------------",
]


def get_autogen_banner(command: str, comment='') -> str:
    """Returns a commented out auto-generated code warning banner.

    command is a fully formatted string representing what command was used
    to auto-generate the source.
    comment is the style of comment supported by the file type.
    """
    lines = []
    command = command.strip()
    lines = [f"{line.format(command=command)}" for line in AUTOGEN_BANNER]
    return apply_comment(lines, comment)


def get_license_banner(comment='') -> str:
    """Returns a commented out license banner.

    comment is the style of comment supported by the file type.
    """
    return apply_comment(LICENSE_BANNER, comment)


def apply_comment(text: list, comment='') -> str:
    """Applies comment to a text paragraph.

    The returned string terminates in a newline.
    """
    if comment:
        comment = f"{comment} "
    return "\n".join([f"{comment}{line}" for line in text]) + "\n"


def main():
    command = "      .util/uvmdvgen/uvmdvgen.py dma -e -eo hw/ip/dma/dv"
    print(get_autogen_banner(command=command, comment="//") + "\n")
    print(get_autogen_banner(command=command, comment="#") + "\n")

    command = ("util/topgen.py -t hw/top_earlgrey/data/top_earlgrey.hjson "
               "-o hw/top_earlgrey")
    print(get_autogen_banner(command=command, comment="//") + "\n")
    print(get_autogen_banner(command=command, comment="#") + "\n")

    command = ("./util/dvsim/dvsim.py hw/top_earlgrey/dv/chip_sim_cfg.hjson "
               "-i chip_plic_all_irqs --waves -v h --local --run-only")
    print(get_autogen_banner(command=command) + "\n")
    print(get_autogen_banner(command=command, comment="#") + "\n")

    print(get_license_banner("//") + "\n\n")
    print(get_license_banner("#") + "\n\n")


if __name__ == '__main__':
    main()
